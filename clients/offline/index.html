<script src="../../dist/nimiq.js"></script>
<script>
    (async function() {
        if (window.Nimiq) {
            await Nimiq.loadOffline();
            Nimiq.GenesisConfig['test']();
        }

        const _privateKey = Nimiq.PrivateKey.unserialize(Nimiq.BufferUtils.fromBase64('boH8Y6CujNS+wBCAs3XBDXzU/1SZW3+KEK+neC1nc8w='));
        const storedKeyPair = Nimiq.KeyPair.derive(_privateKey);

        const recipient = Nimiq.Address.fromUserFriendlyAddress('NQ26 8MMT 8317 VD0D NNKE 3NVA GBVE UY1E 9YDF');

        console.log("Export keypair encrypted");
        const encryptedKeyPair = await storedKeyPair.exportEncrypted('my very long pass phrase');
        console.info(encryptedKeyPair);

        console.log('Import encrypted keypair');
        const keyPair = await Nimiq.KeyPair.fromEncrypted(encryptedKeyPair, 'my very long pass phrase');

        console.log("Create new transaction");
        const canonicals = {
            value: 10000000,
            fee: 1,
            validityStart: 1000
        };
        const tx = new Nimiq.BasicTransaction(keyPair.publicKey, recipient, canonicals.value, canonicals.fee, canonicals.validityStart);
        console.info(tx);

        console.log("Signing transaction");
        const signature = Nimiq.Signature.create(keyPair.privateKey, keyPair.publicKey, tx.serializeContent());
        console.info(signature);

        console.log("Creating signature proof");
        tx.signature = signature;
        console.info("Finished:", tx);
    })();
</script>
